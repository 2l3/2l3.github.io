@{
    ViewBag.Title = "Print";
    Layout = null;
}
<html lang="ar-eg" dir="rtl">
<head>

    <style>
        @@page {
            size: auto; /* auto is the initial value */
            margin: 0; /* this affects the margin in the printer settings */
            border: 1px solid black;
        }
    </style>
</head>
<body style="overflow-x:hidden;border: 1px solid;">
    <br/>
    <div id="imageDIV" style="width:500px;height:500px;">
        <h5 style="text-align:center;font-size:10px">@ViewBag.PPMText</h5>
        <h5 style="text-align:center;font-size:10px">BIOMEDICAL ENGINEERING</h5>
        <h5 style="text-align:center;font-size:10px">LAST PPM : @ViewBag.DateFrom</h5>
        <h5 style="text-align:center;font-size:10px">NEXT PPM : @ViewBag.DateTo</h5>
    </div>
    <div style="display:none" id="previewImage"></div>
    <a href="" id="download" style="display:none"></a>
    <script type="text/javascript" src="~/Content2/Ar-assets/js/lib/jquery-1.11.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.4.1/jspdf.debug.js" type="text/javascript"></script>
    <script>

        var element = $("#imageDIV"); // global variable
        var getCanvas; // global variable
        $('document').ready(function () {
            html2canvas(element, {
                width: 500, height: 500,
                scale:15,
                onrendered: function (canvas) {
                    $("#previewImage").append(canvas);
                    getCanvas = canvas;
                }
            });
            setTimeout(function () {
                var imgageData = getCanvas.toDataURL("image/png");
                $("#download").attr("download", "image.png").attr("href", imgageData);
                document.getElementById("download").click();
            }, 3000);

           
        });


        //window.print();

    </script>
</body>
</html>

